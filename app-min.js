const express=require("express"),hbs=require("express-handlebars"),bodyParser=require("body-parser"),mongoose=require("mongoose"),app=express(),request=require("request");var nodemailer=require("nodemailer"),multer=require("multer"),upload=multer({dest:"/tmp/"});app.use(express.static("assets")),app.use(bodyParser.urlencoded({extended:!0})),app.engine("hbs",hbs({extname:"hbs",defaultLayout:"layouts",layoutsDir:__dirname+"/views/layouts/"})),app.set("view engine","hbs"),mongoose.connect("mongodb://ncdesignco:NCAK20!9@ds031223.mlab.com:31223/heroku_1gbtwtrj");const pacificshopSchema=new mongoose.Schema({name:String,image1:String,image2:String,image3:String,price_small:Number,price_big:Number,size:String,desc:String,imagemock:String,class:String}),PacificShop=mongoose.model("PacificShop",pacificshopSchema);var productMetaSchema=new mongoose.Schema({garment:String,color:String,size:String,image1:String,image2:String,image3:String,images:String,price_small:Number,price_big:Number,productID:{type:mongoose.Schema.Types.ObjectId,ref:"PacificShop"}});const ProductMeta=mongoose.model("ProductMeta",productMetaSchema);function sendMails(e,t){var o="<p>name-</p>"+e.name+"<p>email-</p>"+e.email+"<p>phone-</p>"+e.phone+"<p>bussinessName-</p>"+e.bussinessName+"<p>QUANTITY-</p>"+e.qty+"<p>type-</p>"+e.type+"<p>service-</p>"+e.service,n=nodemailer.createTransport({service:"gmail",auth:{user:"aanandchamp@gmail.com",pass:"omsairam@#jio"}}),i={from:e.email,to:"aanandchamp@gmail.com",subject:"Contact Info",html:o,attachments:[{filename:t.originalname,path:t.path}]};n.sendMail(i,function(e,t){e?console.log(e):console.log("Email sent: "+t.response)})}PacificShop.create({name:"DUDE MTN",imagemock:"/img/shop/matt_h_collection/matt_h_dude_mtn/matt_h_dude_mtn_mock.png",image1:"/img/skiff_1_shop.jpg",image2:"/img/skiff_2_shop.jpg",image3:"/img/shop/matt_h_collection/matt_h_dude_mtn/matt_h_dude_mtn_mock.png",desc:"test",size:["SM","M","L","XL","2XL","3XL","4XL"],price_small:17.99,price_big:19.99},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM:"),console.log(t),ProductMeta.create({garment:"Uni - Sex Tee Shirts",color:["Black","Gray","Navy","Royal","Dk Green"],images:["/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_black.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_ash.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_navy.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_royal.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_dkgreen.png"],image1:"/img/shop/matt_h_collection/matt_h_dude_mtn/uni_tshirt/matt_h_dude_mtn_uni_black.png",image2:"/img/download3.jpg",image3:"/img/downloa4.jpg",size:["SM","M","L","XL","2XL","3XL","4XL"],price_small:17.99,price_big:19.99,productID:t._id},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM: "),console.log(t))}),ProductMeta.create({garment:"Uni - Sex Hoodies",color:["Black","Gray","Navy","Royal","Dk Green"],images:["/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_black.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_gray.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_navy.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_royal.png","/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_dkgreen.png"],image1:"/img/shop/matt_h_collection/matt_h_dude_mtn/uni_hoodie/matt_h_dude_mtn_hoodie_black.png",image2:"/img/download3.jpg",image3:"/img/downloa4.jpg",size:["SM","M","L","XL","2XL","3XL","4XL"],price_small:17.99,price_big:19.99,productID:t._id},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM: "),console.log(t))}),ProductMeta.create({garment:"Premium Mens Tee Shirt",color:["Vintage Black","Gray","Navy","Ocean Blue","Heather Green"],images:["/img/shop/matt_h_collection/matt_h_dude_mtn/mens_tshirt/matt_h_dude_mtn_menst_vintageblack.png","/img/shop/matt_h_collection/matt_h_dude_mtn/mens_tshirt/matt_h_dude_mtn_menst_gray.png","/img/shop/matt_h_collection/matt_h_dude_mtn/mens_tshirt/matt_h_dude_mtn_menst_navy.png","/img/shop/matt_h_collection/matt_h_dude_mtn/mens_tshirt/matt_h_dude_mtn_menst_oceanblue.png","/img/shop/matt_h_collection/matt_h_dude_mtn/mens_tshirt/matt_h_dude_mtn_menst_heathergreen.png"],image:"/img/download2.jpg",image1:"/img/download.jpg",image2:"/img/download3.jpg",image3:"/img/downloa4.jpg",price_small:19.99,price_big:21.99,size:["SM","M","L","XL","2XL","3XL","4XL"],productID:t._id},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM: "),console.log(t))}),ProductMeta.create({garment:"Womens V - Neck",color:["Black","New Navy","Dark Fuchsia","Deep Royal"],images:["/img/shop/matt_h_collection/matt_h_dude_mtn/womans_vneck/matt_h_dude_mtn_womansv_black.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_vneck/matt_h_dude_mtn_womansv_newnavy.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_vneck/matt_h_dude_mtn_womansv_darkfuchsia.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_vneck/matt_h_dude_mtn_womansv_deeproyal.png"],image:"/img/download2.jpg",image1:"/img/download.jpg",image2:"/img/download3.jpg",image3:"/img/downloa4.jpg",price_small:19.99,price_big:21.99,size:["SM","M","L","XL","2XL","3XL","4XL"],productID:t._id},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM: "),console.log(t))}),ProductMeta.create({garment:"Womens Tee Shirt",color:["Black","New Navy","Dark Fuchsia","Deep Royal"],images:["/img/shop/matt_h_collection/matt_h_dude_mtn/womans_tshirt/matt_h_dude_mtn_womans_black.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_tshirt/matt_h_dude_mtn_womans_newnavy.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_tshirt/matt_h_dude_mtn_womans_darkfuchsia.png","/img/shop/matt_h_collection/matt_h_dude_mtn/womans_tshirt/matt_h_dude_mtn_womans_deeproyal.png"],image:"/img/download2.jpg",image1:"/img/download.jpg",image2:"/img/download3.jpg",image3:"/img/downloa4.jpg",price_small:19.99,price_big:21.99,size:["SM","M","L","XL","2XL","3XL","4XL"],productID:t._id},function(e,t){e?console.log(e):(console.log("CREATED SHOP ITEM: "),console.log(t))}))}),app.get("/shop",function(e,t){PacificShop.find({},function(e,o){e?console.long(e):t.render("matt-hamiliton-collection",{pacificshop:o})})}),app.get("/shop/:id",function(e,t){PacificShop.findById(e.params.id,function(e,o){e?console.log(e):t.render("shop-item",{pacificshop:o})})}),app.get("/",function(e,t){t.render("index")}),app.get("/services",function(e,t){t.render("services")}),app.get("/print-requirements",function(e,t){t.render("print-requirements")}),app.get("/contact",function(e,t){t.render("contact")}),app.post("/contact",upload.single("file"),function(e,t){console.log(e.body),sendMails(e.body,e.file)}),app.get("/garment",function(e,t){ProductMeta.find({productID:e.query._id},function(e,o){e?console.log(e):t.send(o)})}),app.get("/garmentSingle",function(e,t){ProductMeta.find({_id:e.query._id},function(e,o){e?console.log(e):t.send(o)})}),app.get("/colors",function(e,t){ProductMeta.find({_id:e.query._id},function(e,o){e?console.log(e):t.send(o)})}),app.get("/size",function(e,t){ProductMeta.find({_id:e.query._id},function(e,o){e?console.log(e):t.send(o)})}),app.listen(process.env.PORT||8002,function(){console.log("Pacific Printing Server Is Running")});